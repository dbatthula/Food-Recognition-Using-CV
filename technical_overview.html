<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Overview - Food Recognition Using Computer Vision</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            overflow-x: auto;
        }
        code {
            font-family: Consolas, "Courier New", Courier, monospace;
            color: #2b2b2b;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="introduction.html">Introduction</a></li>
                <li><a href="technical_overview.html">Technical Overview</a></li>
                <li><a href="case_studies.html">Case Studies</a></li>
                <li><a href="demo.html">Interactive Demo</a></li>
                <li><a href="bibliography.html">Annotated Bibliography</a></li>
                <li><a href="conclusion.html">Conclusion</a></li>
                <li><a href="media_credits.html">Media Credits</a></li>
            </ul>
        </nav>
    </header>

    <!-- CNN Overview -->
    <section>
        <h2>Convolutional Neural Networks (CNNs) for Food Recognition</h2>
        <p>Convolutional Neural Networks (CNNs) are a deep learning method widely used for tasks like image classification, object detection, and feature extraction. CNNs are particularly effective in handling image data due to their deep structure and the convolution process, which allows for object detection in various domains, including food classification.</p>
        
        <h3>Convolution Layer</h3>
        <p>The convolution layer extracts image features using filters that slide over the input image to detect edges and textures.</p>
        <pre><code class="language-python">
import tensorflow as tf
from tensorflow.keras import layers, models

# Sample CNN model
model = models.Sequential([
    layers.Conv2D(32, (3, 3), activation='relu', input_shape=(150, 150, 3)),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(64, (3, 3), activation='relu'),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(128, (3, 3), activation='relu'),
    layers.MaxPooling2D((2, 2)),
    layers.Flatten(),
    layers.Dense(512, activation='relu'),
    layers.Dense(101, activation='softmax')  # 101 food categories in Food-101 dataset
])

model.summary()
        </code></pre>

        <h3>Pooling Layer</h3>
        <p>Pooling layers downsample the input by selecting the maximum value from a feature map, reducing its dimensions while retaining important information.</p>
        <pre><code class="language-python">
# Max-pooling layer
model.add(layers.MaxPooling2D((2, 2)))

# Another convolution followed by max-pooling
model.add(layers.Conv2D(64, (3, 3), activation='relu'))
model.add(layers.MaxPooling2D((2, 2)))
        </code></pre>

        <h3>Fully Connected Layer</h3>
        <p>After feature extraction, fully connected layers classify the food item based on the extracted features.</p>
        <pre><code class="language-python">
# Fully connected layer with softmax activation for classification
model.add(layers.Flatten())
model.add(layers.Dense(512, activation='relu'))
model.add(layers.Dense(101, activation='softmax'))  # Output layer with 101 categories
        </code></pre>

        <h3>CNN Application in Food Recognition</h3>
        <p>CNNs are effective in recognizing food by classifying images under consistent conditions like brightness and distance. For example, the model could classify dishes such as "rice," "fried chicken," or "tofu" using a dataset such as Food-101.</p>
    </section>

    <!-- Food Dataset Overview -->
    <section>
        <h2>Sample Images from the Food-101 Dataset</h2>
        <p>The Food-101 dataset contains over 101,000 images across 101 categories of food, used to train and test machine learning models for food classification.</p>
        <img src="https://data.vision.ee.ethz.ch/cvl/datasets_extra/food-101/static/img/food-101.jpg" alt="Food-101 Dataset Samples" class="img-responsive">
    </section>

    <!-- Food Classification Overview -->
    <section>
        <h2>Food Classification and Identification</h2>
        <p>Food classification systems aim to categorize food items into predefined categories like "pizza," "pasta," or "salad." CNNs have greatly improved the accuracy of food identification compared to traditional methods.</p>

        <h3>Food Classification Example Using CNN</h3>
        <pre><code class="language-python">
# Training a CNN on Food-101 dataset for food classification
from tensorflow.keras.preprocessing.image import ImageDataGenerator

# Data generators for training and validation
train_datagen = ImageDataGenerator(rescale=1./255)
validation_datagen = ImageDataGenerator(rescale=1./255)

train_generator = train_datagen.flow_from_directory(
    'data/food-101/train',
    target_size=(150, 150),
    batch_size=32,
    class_mode='categorical'
)

validation_generator = validation_datagen.flow_from_directory(
    'data/food-101/validation',
    target_size=(150, 150),
    batch_size=32,
    class_mode='categorical'
)

# Compile the model
model.compile(optimizer='adam', 
              loss='categorical_crossentropy', 
              metrics=['accuracy'])

# Train the model
history = model.fit(train_generator, 
                    epochs=10, 
                    validation_data=validation_generator)
        </code></pre>
        <p>After training, the model can classify images of food into categories based on the Food-101 dataset.</p>
    </section>

    <!-- Food Weight Estimation -->
    <section>
        <h2>Food Weight Estimation</h2>
        <p>Estimating the weight of food items from images is important for nutritional analysis. The challenge is converting 2D images into weight predictions using features such as texture, shape, and depth.</p>

        <h3>Food Weight Estimation with Image Segmentation</h3>
        <pre><code class="language-python">
# Example of using OpenCV for food segmentation
import cv2

# Load an image of food
image = cv2.imread('food_image.jpg')

# Convert image to grayscale
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

# Apply a binary threshold to create a mask
_, mask = cv2.threshold(gray, 100, 255, cv2.THRESH_BINARY)

# Find contours of the food object
contours, _ = cv2.findContours(mask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

# Draw contours on the original image
cv2.drawContours(image, contours, -1, (0, 255, 0), 2)

# Display the segmented image
cv2.imshow('Food Segmentation', image)
cv2.waitKey(0)
cv2.destroyAllWindows()
        </code></pre>
        <p>By segmenting food from the background, we can estimate the volume and calculate the weight using known densities of the food item.</p>
    </section>

    <footer>
        <p>&copy; 2024 Food Recognition Tutorial. All rights reserved.</p>
    </footer>
</body>
</html>
